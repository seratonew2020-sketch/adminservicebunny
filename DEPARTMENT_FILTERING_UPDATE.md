# üéØ Schedule Page - Department Filtering Update

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà**: 2026-02-14 15:12
**Feature**: Department Dropdown Filtering

---

## ‚úÖ **‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°**

### **Department Filtering Based on Role**

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤**: ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô dropdown ‡πÅ‡∏°‡πâ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**:
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° `filteredDepartments` computed property
- ‚úÖ Admin ‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‚úÖ ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
- ‚úÖ Auto-select ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤

---

## üîß **‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏Ñ‡πâ‡∏î**

### **‡πÑ‡∏ü‡∏•‡πå**: `/src/pages/schedule.vue`

#### **1. Computed Property** (Line 173-185)
```javascript
// üîí Filtered departments based on role
const filteredDepartments = computed(() => {
  // Admin ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å
  if (authStore.isAdmin) {
    return departments.value
  }

  // ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
  const userDeptId = authStore.user?.dept_id
  if (!userDeptId) return [] // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏ô‡∏Å ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏∞‡πÑ‡∏£

  return departments.value.filter(d => d.id === userDeptId)
})
```

#### **2. Template Update** (Line 411)
```vue
<!-- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å -->
<v-select
  :items="departments.map(d => ({ title: d.name, value: d.id }))"
  ...
/>

<!-- ‡πÄ‡∏õ‡πá‡∏ô -->
<v-select
  :items="filteredDepartments.map(d => ({ title: d.name, value: d.id }))"
  ...
/>
```

#### **3. Auto-Select on Mount** (Line 326-329)
```javascript
onMounted(async () => {
  // üîí Auto-select ‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
  if (!authStore.isAdmin && authStore.user?.dept_id) {
    deptId.value = authStore.user.dept_id
  }

  await load()
  startAutoRefresh()
})
```

---

## üìä **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**

### **Admin/Manager**:
```
Dropdown ‡πÅ‡∏ú‡∏ô‡∏Å:
- Bar
- Entertainment
- General Staff
- Housekeeping
- Human Resources
- Kitchen
- Management
- PR Service
- Production Line
- Sales Department
- Service

‚úÖ ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 12 ‡πÅ‡∏ú‡∏ô‡∏Å
```

### **‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤** (dept_id: 5 - Entertainment):
```
Dropdown ‡πÅ‡∏ú‡∏ô‡∏Å:
- Entertainment

‚úÖ ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 1 ‡πÅ‡∏ú‡∏ô‡∏Å (‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á)
‚úÖ Auto-select "Entertainment" ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
‚úÖ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ
```

---

## üß™ **‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö**

### **Test Cases**:

#### **1. Admin User**
- [ ] Login ‡∏î‡πâ‡∏ß‡∏¢ Admin
- [ ] ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ `/schedule`
- [ ] ‡∏Ñ‡∏•‡∏¥‡∏Å dropdown ‡πÅ‡∏ú‡∏ô‡∏Å
- [ ] ‚úÖ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (12 ‡πÅ‡∏ú‡∏ô‡∏Å)

#### **2. Employee User**
- [ ] Login ‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (dept_id: 5)
- [ ] ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ `/schedule`
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö dropdown ‡πÅ‡∏ú‡∏ô‡∏Å
- [ ] ‚úÖ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞ "Entertainment"
- [ ] ‚úÖ ‡∏Ñ‡∏ß‡∏£ auto-select "Entertainment"

#### **3. Employee Without Department**
- [ ] Login ‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ dept_id
- [ ] ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ `/schedule`
- [ ] ‚úÖ Dropdown ‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ñ‡∏ß‡∏£‡∏ß‡πà‡∏≤‡∏á

---

## üé® **UI/UX Improvements**

### **Before**:
- ‚ùå ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏™‡∏±‡∏ö‡∏™‡∏ô)
- ‚ùå ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏≠‡∏á
- ‚ùå ‡∏≠‡∏≤‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à

### **After**:
- ‚úÖ ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô)
- ‚úÖ Auto-select ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (‡∏™‡∏∞‡∏î‡∏ß‡∏Å)
- ‚úÖ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î)

---

## üîê **Security & Privacy**

### **Data Isolation**:
1. ‚úÖ ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
2. ‚úÖ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏î‡∏π‡πÅ‡∏ú‡∏ô‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ
3. ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏Å‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà Backend (RLS bypass)

### **Role-based Access**:
- **Admin**: Full access ‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å
- **Employee**: Limited access ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á

---

## üìù **‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á**

### **‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ**: 2 ‡πÑ‡∏ü‡∏•‡πå
- `/src/pages/schedule.vue` (+17 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
- `/SCHEDULE_PAGE_UPDATES.md` (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï)

### **Features ‡πÄ‡∏û‡∏¥‡πà‡∏°**: 3 features
1. ‚úÖ Filtered departments dropdown
2. ‚úÖ Auto-select department
3. ‚úÖ Role-based department access

### **‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ**: ~15 ‡∏ô‡∏≤‡∏ó‡∏µ

---

## üöÄ **Next Steps**

### **Recommended**:
1. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏±‡∏ö user ‡∏à‡∏£‡∏¥‡∏á
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö edge cases (user ‡πÑ‡∏°‡πà‡∏°‡∏µ dept_id)
3. ‡πÄ‡∏û‡∏¥‡πà‡∏° tooltip ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÑ‡∏°‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

### **Future Enhancements**:
- Manager ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡∏î‡∏π‡πÅ‡∏• (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ú‡∏ô‡∏Å)
- ‡πÄ‡∏û‡∏¥‡πà‡∏° badge ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å

---

**‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠**: 2026-02-14 15:12
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞**: ‚úÖ **COMPLETE**
**‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤**: Antigravity AI

üéØ **Department Filtering ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!**
